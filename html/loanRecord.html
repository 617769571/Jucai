<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title></title>
    <link href="../css/mui.min.css" rel="stylesheet"/>
	<link href="../css/base.css" rel="stylesheet"/>
	<link href="../css/loanRecord.css" rel="stylesheet"/>
</head>
<body>
	<header id="header" class="mui-bar mui-bar-transparent">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		<h1 class="mui-title">借款记录</h1>
	</header>

	<div id="container" class="mui-content">
			
	</div>
	
	<script src="../js/jquery-3.3.1.min.js"></script>
	<script src="../js/mui.min.js"></script>
	<script src="../js/util.js"></script>
	<script src="../js/base.js"></script>
	<script type="text/javascript" charset="utf-8">
		(function() {
			mui.init();
			mui.plusReady(function() {
				var userInfo = JSON.parse(plus.storage.getItem('userInfo'))
				POST({
					url: '/listBorrowListDTO',
					data: { customerId:  userInfo.id},
					success: function(res){
						let _html = ''
						for(let i in res.data){
							let bgClass = 'bg-green';
							switch(res.data[i].statusStr){
								case '审核失败':
									bgClass = 'bg-gray';
									break;
								case '异常':
									bgClass = 'bg-gray';
									break;
								case '未还款':
									bgClass = 'bg-red';
									break;
							}
							_html+=`
							<div class="loan-list-box" >
								<div class="loan-list" data-id="${res.data[i].borrowInfoId}">
									<div class="loan-money-date">
										<div class="loan-money">
											金额：${res.data[i].borrowAmount}
										</div>
										<div class="loan-date">
											期限：${res.data[i].termDay}天
										</div>
									</div>
									<div>
										订单号：${res.data[i].orderNo}
									</div>
								</div>
								<div class="loan-list-box-before"></div>
								<div class="loan-list-ribbon ${bgClass}">
										${res.data[i].statusStr}
								</div>
							</div>
							`;


						}
						$('#container').html(_html);
						addClick();
					}
				})
			});
		})();
		function addClick(){
			mui('body').on('tap', '.loan-list', function() {
				console.log($(this).attr('data-id'));
				var href = 'loanItem.html?id='+$(this).attr('data-id');
				plus.storage.setItem('borrowInfoId',$(this).attr('data-id'));
					mui.openWindow(href);
					// mui.openWindow({url:href,extras:{id:id}});
					
			});
		}
	</script>
</body>
</html>